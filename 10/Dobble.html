<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!--
    Dobble game ë£°
    ê°™ì€ ê·¸ë¦¼ì˜ ì´ë¯¸ì§€ê°€ ìˆìœ¼ë©´ ê·¸ ì´ë¯¸ì§€ì˜ ì´ë¦„ì„ íƒ€ì´í•‘í•´ì„œ ìì‹ ì˜ ì¹´ë“œë¥¼ í•˜ë‚˜ì”© ì¤„ì—¬ë‚˜ê°€ëŠ” ê²Œì„
    15ê°œì˜ ì‹¬ë³¼ì´ ìˆê³  í•œì¥ì˜ ì¹´ë“œì—ëŠ” 8ê°œì˜ ì‹¬ë³¼ì´ ë“¤ì–´ìˆëŠ” ì¹´ë“œ 30ì¥ì´ ì¡´ì¬í•œë‹¤
    ë‹¨, ì–´ë–¤ ì¹´ë“œ ë‘ì¥ì„ í¼ì³ë„ í•­ìƒ ë˜‘ê°™ì€ ì´ë¯¸ì§€ê°€ í•œê°œ ì´ìƒì€ ì¡´ì¬í•œë‹¤(ì‚¬ë…¸ í‰ë©´(ì¤‘ë³µì˜ ê°¯ìˆ˜ê°€ í•˜ë‚˜)...or ì¤‘ë³µì˜ ê°¯ìˆ˜ë§Œ í•œê°œ ì´ìƒ ë§ì¶”ê¸°)
    ê²Œì„ ì‹œê°„ì€ 30ì´ˆì´ê³  ì²˜ìŒ ë‚´ ì¹´ë“œëŠ” 15ì¥ìœ¼ë¡œ ì‹œì‘í•œë‹¤
    ì œí•œ ì‹œê°„ ë‚´ì— ë‚¨ì€ ì¹´ë“œ ê°¯ìˆ˜ê°€ 0ì´ë˜ë©´ ë‚´ê°€ ì´ê¸°ê³ , ì‹œê°„ ì´ˆê³¼ì‹œ ë‚¨ì€ ì¹´ë“œê°€ í•œê°œ ì´ìƒì´ë©´ ë‚´ê°€ ì§€ëŠ” ê²Œì„ì´ë‹¤.
    -->

    <!--
    ê¸°ëŠ¥ êµ¬í˜„
    íƒ€ì„ë¦¬ë°‹ 60ì´ˆ
    ì¹´ë“œ í•œì¥ ë‹¹ 8ê°œì˜ ì‹¬ë³¼(ì„ì˜ì˜ ì¹´ë“œ ë‘ì¥ì—ëŠ” ë˜‘ê°™ì€ ì´ë¯¸ì§€ê°€ í•œì¥ì´ìƒì€ ì¡´ì¬í•œë‹¤ -> ì¤‘ë³µì˜ ê°¯ìˆ˜ê°€ í•œê°œ ì´ìƒì´ê¸°ë§Œ í•˜ë©´ ë˜ëŠ” ë°©ë²•ìœ¼ë¡œ êµ¬í˜„(íŒŒë…¸ í‰ë©´ì—ì„œ ì´ì–´ì§€ëŠ” ìœ í•œ ì‚¬ì˜ í‰ë©´...êµ¬í˜„ ì•ˆë¨)
        -8ê°œì˜ ì‹¬ë³¼ ëœë¤ ê³ ë¥´ê¸°
        -8ê°œì˜ ì‹¬ë³¼ì´ ë“  ì¹´ë“œ ë§Œë“¤ê¸°
        -ì¤‘ë³µ ì‹¬ë³¼ íŒë³„
        -ë ˆë²¨ ë³„ë¡œ ì¹´ë“œ ìˆ˜ ë‹¤ë¥´ê²Œ
        -ë¬´ë¹™ ì‹¬ë³¼
    ê²¹ì¹˜ëŠ” ì‹¬ë³¼ì˜ ì´ë¦„ì„ íƒ€ì´í•‘í•˜ê³  ì •ë‹µì¸ì§€ ì•„ë‹Œì§€ êµ¬ë¶„í•˜ê¸°
        ì •ë‹µì´ë©´, ë‚´ ì¹´ë“œì˜ ìˆ˜ê°€ í•˜ë‚˜ ì¦ê°€
        ì˜¤ë‹µì´ë©´, ì¹´ë“œ ìˆ˜ê°€ í•˜ë‚˜ ëŠ˜ì–´ë‚¨
    ì œí•œì‹œê°„ ë‚´ì— ë‚¨ì€ ì¹´ë“œ ì˜ ìˆ˜
        0ê°œ ì´ìƒì´ë©´ ê²Œì„ ì‹¤íŒ¨
        0ê°œë©´ ê²Œì„ ì„±ê³µ
            -íƒ€ì´ë¨¸
    ë ˆë²¨ ì„ íƒì— ë”°ë¼ ì¹´ë“œ ìˆ˜ ë³€ê²½
    
    -->
    <style>
      body {
        background-color: #171b25;
        color: white;
      }
      .board {
        display: flex;
        justify-content: center;
        gap: 20px;
      }
      .card {
        background-color: #232938;
        width: 500px;
        height: 500px;
        border-radius: 20px;
        position: relative;
        top: 10px;
      }
      .card-wrapper {
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .card-title {
        font-size: 20px;
        font-weight: bold;
        color: #fff;
        text-align: center;
        height: 10px;
      }
      .box {
        display: flex;
        justify-content: center;
        background-color: #232938;
        height: 200px;
        margin-top: 50px;
        border-radius: 20px;
      }
      .answerbox {
        text-align: center;
      }
      .start {
        padding: 13px;
        background-color: rgb(40, 249, 40);
        border: none;
        border-radius: 10px;
        width: 110px;
      }
      .level {
        padding: 13px;
        background-color: rgb(249, 40, 85);
        border: none;
        border-radius: 10px;
        width: 110px;
      }
      #timeBar {
        width: 100%;
        height: 15px;
        margin-top: 10px;
        transition: width 1s linear;
        border-radius: 8px;
      }
      #answer {
        padding: 7px;
        width: 230px;
      }
      #btn {
        padding: 9px;
        background-color: rgb(40, 249, 40);
        border: none;
        border-radius: 10px;
        width: 80px;
      }
      #setting {
        margin-top: 20px;
        margin-left: 10px;
      }
    </style>
  </head>
  <body>
    <div class="board">
      <div class="card-wrapper">
        <div id="yourCard" class="card"></div>
        <h2 class="card-title">ì»´í“¨í„°</h2>
      </div>
      <div class="card-wrapper">
        <div id="myCard" class="card"></div>
        <h2 class="card-title">
          <div id="counter" class="card-title">
            ë‚´ ì¹´ë“œ : <b id="myCount">-</b>
          </div>
        </h2>
      </div>
    </div>

    <div id="box" class="box">
      <div id="answerbox">
        <h2>
          <div id="feedback">ê²¹ì¹˜ëŠ” ì‹¬ë³¼ì„ ì…ë ¥í•˜ì„¸ìš”</div>
        </h2>
        <form id="gameForm" autocomplete="off">
          <input id="answer" type="text" />
        </form>

        <div id="setting">
          <button id="start" class="start">ì‹œì‘í•˜ê¸°</button>
          <select id="level" class="level" onchange="level()">
            <option value="1" selected="selected">LEVEL1</option>
            <option value="2">LEVEL2</option>
            <option value="3">LEVEL3</option>
          </select>
        </div>
      </div>
    </div>

    <div id="timeBar"></div>

    <script>
      const symbols = [
        { icon: "â­", name: "ë³„" },
        { icon: "ğŸ", name: "ì‚¬ê³¼" },
        { icon: "ğŸŒ", name: "ë°”ë‚˜ë‚˜" },
        { icon: "ğŸ‡", name: "í¬ë„" },
        { icon: "ğŸ“", name: "ë”¸ê¸°" },
        { icon: "ğŸ‰", name: "ìˆ˜ë°•" },
        { icon: "ğŸ", name: "íŒŒì¸ì• í”Œ" },
        { icon: "ğŸ¥•", name: "ë‹¹ê·¼" },
        { icon: "ğŸŒ½", name: "ì˜¥ìˆ˜ìˆ˜" },
        { icon: "ğŸ„", name: "ë²„ì„¯" },
        { icon: "ğŸŒ™", name: "ë‹¬" },
        { icon: "â˜€ï¸", name: "í•´" },
        { icon: "âš¡ï¸", name: "ë²ˆê°œ" },
        { icon: "ğŸ”¥", name: "ë¶ˆ" },
        { icon: "ğŸ’§", name: "ë¬¼" },
      ];

      const LEVEL_CARDS = {
        1: 10,
        2: 15,
        3: 20,
      };

      const per = 8;

      const myCard = document.getElementById("myCard");
      const yourCard = document.getElementById("yourCard");
      const feedback = document.getElementById("feedback");
      const answerInput = document.getElementById("answer");
      const startBtn = document.getElementById("start");
      const myCountEl = document.getElementById("myCount");
      const timeBar = document.getElementById("timeBar");

      let my = [];
      let your = [];
      let mySymbols = [];
      let yourSymbols = [];

      let currentLevel = 1;
      let total = LEVEL_CARDS[currentLevel];
      let myCardsLeft = total;

      let moveTimer = null;
      let duration = 30;
      let timerId = null;
      let isRunning = false;

      // 8ê°œì˜ ëœë¤ ì‹¬ë³¼ ë½‘ê¸°
      function pickSymbols() {
        const picks = [];
        while (picks.length < per) {
          const pick = Math.floor(Math.random() * symbols.length);
          if (!picks.includes(pick)) picks.push(pick);
        }
        const card = picks.map((i) => symbols[i]);
        return card;
      }

      // 8ê°œì˜ ì‹¬ë³¼ì´ ëœë¤ìœ¼ë¡œ ë“¤ì–´ìˆëŠ” ì¹´ë“œ ë§Œë“¤ê¸°
      function makeRandomCard() {
        my = pickSymbols();
        your = pickSymbols();
      }

      // ì‹¬ë³¼ í™”ë©´ì— ê·¸ë¦¬ê¸°

      function randomSpeed(maxSpeed) {
        return Math.random() * maxSpeed - Math.random() * maxSpeed;
      }

      function MovingSymbols(sym, parent) {
        this.x = Math.random() * 440;
        this.y = Math.random() * 440;
        this.vX = randomSpeed(2);
        this.vY = randomSpeed(2);

        this.el = document.createElement("div");
        this.el.innerHTML = sym.icon;
        this.el.style.position = "absolute";
        this.el.style.left = this.x + "px";
        this.el.style.top = this.y + "px";
        this.el.style.fontSize = "60px";

        parent.appendChild(this.el);

        this.move = () => {
          this.x += this.vX;
          this.y += this.vY;

          if (this.x < 0 || this.x > 440) this.vX *= -1;
          if (this.y < 0 || this.y > 440) this.vY *= -1;

          this.el.style.left = this.x + "px";
          this.el.style.top = this.y + "px";
        };
      }

      // ê²¹ì¹˜ëŠ” ì‹¬ë³¼ì˜ ì´ë¦„ ì°¾ê¸°
      function findSymbolsNames() {
        const matches = [];
        for (let a of my) {
          for (let b of your) {
            if (a.name === b.name) {
              matches.push(a.name);
            }
          }
        }
        return matches;
      }

      //í™”ë©´ì— ì¹´ë“œ ì¶œë ¥
      function drawCards() {
        myCard.innerHTML = "";
        yourCard.innerHTML = "";

        my.forEach((sym) => {
          mySymbols.push(new MovingSymbols(sym, myCard));
        });

        your.forEach((sym) => {
          yourSymbols.push(new MovingSymbols(sym, yourCard));
        });

        clearInterval(moveTimer);
        moveTimer = setInterval(() => {
          mySymbols.forEach((s) => s.move());
          yourSymbols.forEach((s) => s.move());
        }, 1000 / 60);
      }

      //ë‚œì´ë„ ì„¤ì •í•˜ê¸°
      function level() {
        const lv = Number(document.getElementById("level").value);

        if (isRunning) {
          alert("ë ˆë²¨ì´ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤. ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”");
          feedback.textContent = "ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”";
          clearInterval(timerId);
          clearInterval(moveTimer);
          isRunning = false;
        }
        currentLevel = lv;
        total = LEVEL_CARDS[currentLevel];

        myCardsLeft = total;
        myCountEl.textContent = myCardsLeft;
        answerInput.value = "";
      }

      //íƒ€ì´ë¨¸
      function startTimer() {
        clearInterval(timerId);
        timeBar.style.width = "100%";
        timeBar.style.background = "rgb(40, 249, 40)";
        let remaining = duration;

        timerId = setInterval(() => {
          remaining--;
          const percent = (remaining / duration) * 100;
          timeBar.style.width = percent + "%";

          if (percent < 30) timeBar.style.background = "red";
          else if (percent < 50) timeBar.style.background = "orange";

          if (remaining <= -1) {
            clearInterval(timerId);
            clearInterval(moveTimer);
            alert("â° ì‹œê°„ ì´ˆê³¼! ë‹¤ì‹œí•˜ì„¸ìš”!");
            feedback.textContent = "ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”";
            isRunning = false;
          }
        }, 1000);
      }

      //ì…ë ¥ ì²˜ë¦¬
      function submitAnswer() {
        const answer = document.getElementById("answer").value;
        const correct = findSymbolsNames();

        if (correct.includes(answer)) {
          myCardsLeft--;
          feedback.textContent = "ì •ë‹µ";
        } else {
          myCardsLeft++;
          feedback.textContent = "ì˜¤ë‹µ";
        }

        myCountEl.textContent = myCardsLeft;
        answerInput.value = "";

        if (myCardsLeft === 0) {
          alert("ì„±ê³µí•˜ì…¨ìŠµë‹ˆë‹¤.");
          feedback.textContent = "ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”";
          clearInterval(timerId);
          clearInterval(moveTimer);
          isRunning = false;
          return;
        }

        makeRandomCard();
        drawCards();
      }

      document.getElementById("gameForm").addEventListener("submit", (e) => {
        if(!isRunning){
          alert("ì‹œì‘í•˜ê¸°ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”");
          return;
        }
        e.preventDefault();
        submitAnswer();
      });

      startBtn.addEventListener("click", () => {
        myCardsLeft = total;
        myCountEl.textContent = myCardsLeft;
        feedback.textContent = "ê²¹ì¹˜ëŠ” ì‹¬ë³¼ì„ ì…ë ¥í•˜ì„¸ìš”";
        makeRandomCard();
        drawCards();
        startTimer();
        isRunning = true;
      });
    </script>
  </body>
</html>
